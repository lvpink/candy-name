<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>æ‹¿ç ´ä»‘å­¤ç‹¬æ£‹ - çº¯å‡€ç‰ˆ</title>
    <style type="text/css">
        /* 1. åŸºç¡€å¸ƒå±€ä¿®å¤ï¼šç¡®ä¿æ‰‹æœºç«¯ä¸æ»šåŠ¨ */
        html, body {
            margin: 0; padding: 0; width: 100%; height: 100%;
            overflow: hidden; background: #222;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }

        /* 2. å¼¹çª—ä¿®å¤ï¼šå†…åµŒå›¾å½¢ä»£æ›¿ç½‘ç»œå›¾ç‰‡ */
        #modalOverlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.95);
            z-index: 999; display: flex; justify-content: center; align-items: center;
        }

        .card {
            width: 85%; max-width: 340px; background: #f4e4bc;
            border-radius: 15px; overflow: hidden; border: 3px solid #8d6e63;
        }

        /* è¿™æ˜¯ä¸€ä¸ªç”¨ä»£ç ç”Ÿæˆçš„â€œè™šæ‹Ÿå›¾ç‰‡â€ï¼Œè§£å†³äº†é»‘å±é—®é¢˜ */
        .napoleon-graphic {
            width: 100%; height: 180px; background: #4e342e;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            color: #f4e4bc; border-bottom: 2px solid #8d6e63;
        }

        .napoleon-graphic::after {
            content: "Napoleon"; font-size: 3rem; font-weight: bold; opacity: 0.2;
        }

        .napoleon-graphic::before {
            content: "ğŸ‡"; font-size: 5rem; /* ä½¿ç”¨ Emoji ä»£æ›¿å›¾ç‰‡ï¼Œç¡®ä¿ 100% æ˜¾ç¤º */
        }

        .content { padding: 20px; text-align: center; font-family: serif; }
        .content h2 { margin: 0; color: #4e342e; letter-spacing: 2px; }
        .content p { font-size: 0.9rem; color: #5d4037; line-height: 1.5; margin: 15px 0; }

        .btn {
            width: 100%; padding: 15px; background: #4e342e; color: #f4e4bc;
            border: none; font-weight: bold; font-size: 1.1rem; cursor: pointer;
        }

        /* 3. æ£‹ç›˜é€‚é…ï¼šè‡ªé€‚åº”æ‰€æœ‰æ‰‹æœºå±å¹•å°ºå¯¸ */
        .game-container {
            width: 100vw; height: 100vh;
            display: flex; flex-direction: column;
            align-items: center; justify-content: space-evenly;
        }

        #gameBoard {
            --cell-size: min(12vw, 6vh); /* åŠ¨æ€è®¡ç®—æ ¼å­å¤§å° */
            display: grid;
            grid-template-columns: repeat(7, var(--cell-size));
            grid-template-rows: repeat(7, var(--cell-size));
            gap: 8px; padding: 15px;
            background: #b3865c; border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .cell {
            width: var(--cell-size); height: var(--cell-size);
            border-radius: 50%; background: rgba(0,0,0,0.2);
            position: relative; cursor: pointer;
        }

        /* ç‰ç’ƒæ£‹å­æ ·å¼ */
        .piece::after {
            content: ""; position: absolute; inset: 4px; border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, #fff, transparent 60%);
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        /* ç å­é¢œè‰² */
        .piece[data-c="1"] { background: #ff4d6d; }
        .piece[data-c="2"] { background: #00b4d8; }
        .piece[data-c="3"] { background: #70e000; }
        .piece[data-c="4"] { background: #ffb703; }
        .piece[data-c="5"] { background: #9381ff; }

        .selected { transform: scale(1.15); filter: brightness(1.3); z-index: 10; border: 2px solid white; }
        .empty { visibility: hidden; }

        .hud { color: #f4e4bc; font-size: 1.2rem; font-weight: bold; }
    </style>
</head>
<body>

<div id="modalOverlay">
    <div class="card">
        <div class="napoleon-graphic"></div>
        <div class="content">
            <h2>æ‹¿ç ´ä»‘çš„åšå¼ˆ</h2>
            <p>1799å¹´ï¼Œæ‹¿ç ´ä»‘è¡Œå†›é€”ä¸­ä»¥æ­¤æ£‹ç£¨ç‚¼å¿ƒæ€§ã€‚æ£‹ç›˜å¦‚æˆ˜åœºï¼Œä»…ç•™ä¸€å­è€…æ–¹ä¸ºç»Ÿå¸…ã€‚</p>
            <button class="btn" onclick="document.getElementById('modalOverlay').style.display='none'">å¼€å¯æ£‹å±€</button>
        </div>
    </div>
</div>

<div class="game-container">
    <div class="hud">å‰©ä½™å…µåŠ›ï¼š<span id="count">37</span></div>
    <div id="gameBoard"></div>
</div>

<script>
    const layout = [
        [0,0,1,1,1,0,0], [0,1,1,1,1,1,0], [1,1,1,1,1,1,1], [1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1], [0,1,1,1,1,1,0], [0,0,1,1,1,0,0]
    ];

    let selected = null, isFirst = true;
    const board = document.getElementById('gameBoard');

    // ç”Ÿæˆæ£‹ç›˜
    layout.forEach((row, y) => {
        row.forEach((cell, x) => {
            const div = document.createElement('div');
            if (cell === 0) {
                div.className = 'cell empty';
            } else {
                div.className = 'cell piece';
                div.dataset.x = x; div.dataset.y = y;
                div.dataset.c = Math.floor(Math.random()*5)+1;
            }
            board.appendChild(div);
        });
    });

    board.addEventListener('click', (e) => {
        const target = e.target.closest('.cell');
        if (!target || target.classList.contains('empty')) return;

        // ç¬¬ä¸€æ­¥ç§»é™¤
        if (isFirst) {
            target.classList.replace('piece', 'target-cell'); // å˜æˆç©ºä½
            target.style.background = 'rgba(0,0,0,0.2)';
            isFirst = false; updateUI(); return;
        }

        // é€‰ä¸­
        if (target.classList.contains('piece')) {
            if (selected) selected.classList.remove('selected');
            selected = target;
            target.classList.add('selected');
        } 
        // ç§»åŠ¨
        else if (selected) {
            const x1 = +selected.dataset.x, y1 = +selected.dataset.y;
            const x2 = +target.dataset.x, y2 = +target.dataset.y;
            
            if ((Math.abs(x1-x2) === 2 && y1 === y2) || (Math.abs(y1-y2) === 2 && x1 === x2)) {
                const mx = (x1+x2)/2, my = (y1+y2)/2;
                const mid = document.querySelector(`[data-x="${mx}"][data-y="${my}"]`);
                
                if (mid && mid.classList.contains('piece')) {
                    // æ‰§è¡Œè·³è·ƒ
                    target.classList.add('piece');
                    target.dataset.c = selected.dataset.c;
                    selected.classList.remove('piece', 'selected');
                    mid.classList.remove('piece');
                    selected = null;
                    updateUI();
                }
            }
        }
    });

    function updateUI() {
        const count = document.querySelectorAll('.piece').length;
        document.getElementById('count').innerText = count;
        if(count === 1) alert("ä¼Ÿå¤§çš„èƒœåˆ©ï¼");
    }
</script>
</body>
</html>
