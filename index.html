<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>æ‹¿ç ´ä»‘å­¤ç‹¬æ£‹ - å²è¯—é‡åˆ¶ç‰ˆ</title>
    <style type="text/css">
        /* æ ¹å¸ƒå±€ä¼˜åŒ–ï¼šç¡®ä¿ä¸æº¢å‡º */
        html, body {
            margin: 0; padding: 0; width: 100%; height: 100%;
            overflow: hidden; background: #2c2c2c;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            font-family: 'Times New Roman', serif;
        }

        /* æ‹¿ç ´ä»‘ä»‹ç»å¼¹çª— - ä½¿ç”¨ Base64 å†…åµŒå›¾ç‰‡ */
        #modalOverlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.9);
            z-index: 9999; display: flex; justify-content: center; align-items: center;
        }

        .napoleon-card {
            width: 85%; max-width: 350px; background: #f4e4bc;
            border-radius: 12px; overflow: hidden; border: 4px solid #8d6e63;
            box-shadow: 0 0 30px rgba(0,0,0,0.5); text-align: center;
        }

        /* è¿™é‡Œæ˜¯å†…åµŒçš„æ‹¿ç ´ä»‘å‰ªå½±å›¾ï¼Œç¡®ä¿ 100% æ˜¾ç¤º */
        .napoleon-img {
            width: 100%; height: 200px;
            background: #000 url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y="0.9em" font-size="90">ğŸ‡</text></svg>') no-repeat center center;
            background-image: url('https://upload.wikimedia.org/wikipedia/commons/thumb/f/fd/David_-_Napoleon_at_the_Saint-Bernard_Pass.jpg/400px-David_-_Napoleon_at_the_Saint-Bernard_Pass.jpg');
            background-size: cover; border-bottom: 3px solid #8d6e63;
        }

        .napoleon-content { padding: 20px; color: #4e342e; }
        .napoleon-content h2 { margin: 0; font-size: 1.5rem; letter-spacing: 2px; }
        .napoleon-content p { font-size: 0.9rem; line-height: 1.6; text-align: justify; margin: 15px 0; }

        .go-btn {
            width: 100%; padding: 15px; background: #4e342e; color: #f4e4bc;
            border: none; font-weight: bold; font-size: 1.1rem; cursor: pointer;
        }

        /* æ¸¸æˆåŒºåŸŸé€‚é…æ–¹æ¡ˆ */
        .game-wrapper {
            display: flex; flex-direction: column; align-items: center;
            width: 100vw; height: 100vh; justify-content: space-around;
            padding: env(safe-area-inset-top) 0 env(safe-area-inset-bottom);
        }

        .game-info { color: #f4e4bc; font-size: 1.2rem; display: flex; gap: 20px; align-items: center; }

        /* æ£‹ç›˜ï¼šä½¿ç”¨ CSS å˜é‡åŠ¨æ€è®¡ç®—å¤§å°ï¼Œç¡®ä¿ä¸è¶…å‡ºå±å¹• */
        #gameBoard {
            --board-size: min(90vw, 80vh);
            width: var(--board-size); height: var(--board-size);
            background: #d2a679 url('https://www.transparenttextures.com/patterns/wood-pattern-7.png');
            border: 8px solid #b3865c; border-radius: 50%;
            display: grid; grid-template-columns: repeat(7, 1fr);
            grid-template-rows: repeat(7, 1fr);
            padding: 10px; box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            box-sizing: border-box;
        }

        .cell {
            display: flex; justify-content: center; align-items: center;
            position: relative;
        }

        .piece-slot {
            width: 85%; height: 85%; border-radius: 50%;
            background: #4a332d; box-shadow: inset 2px 2px 8px rgba(0,0,0,0.6);
            cursor: pointer; position: relative;
        }

        /* ç‰ç’ƒç å­ */
        .has-piece::after {
            content: ""; position: absolute; inset: 5%; border-radius: 50%;
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .piece-slot[data-color="1"]::after { background: radial-gradient(circle at 30% 30%, #ff5f6d, #b91d1d); }
        .piece-slot[data-color="2"]::after { background: radial-gradient(circle at 30% 30%, #4facfe, #003399); }
        .piece-slot[data-color="3"]::after { background: radial-gradient(circle at 30% 30%, #43e97b, #1b5e20); }
        .piece-slot[data-color="4"]::after { background: radial-gradient(circle at 30% 30%, #f6d365, #e65100); }
        .piece-slot[data-color="5"]::after { background: radial-gradient(circle at 30% 30%, #a18cd1, #4a148c); }

        .selected::after { transform: scale(1.2) translateY(-5px); filter: brightness(1.2); box-shadow: 0 10px 15px rgba(0,0,0,0.5); }
        
        .reset-btn {
            background: none; border: 1px solid #f4e4bc; color: #f4e4bc;
            padding: 5px 15px; border-radius: 20px; font-size: 0.8rem;
        }
    </style>
</head>
<body>

<div id="modalOverlay">
    <div class="napoleon-card">
        <div class="napoleon-img"></div>
        <div class="napoleon-content">
            <h2>Solo Noble</h2>
            <p>1799å¹´ï¼Œæ‹¿ç ´ä»‘ç¿»è¶Šé˜¿å°”å‘æ–¯å±±æ—¶ï¼Œå¸¸åœ¨è¡Œè¥ä¸­ä»¥æ­¤æ£‹æ€ç´¢æˆ˜ç•¥ã€‚æ£‹ç›˜å¦‚æˆ˜åœºï¼Œç§»é™¤ä¸€é¢—æ£‹å­ï¼Œå¼€å§‹ä½ çš„åšå¼ˆã€‚ç›®æ ‡ï¼šæœ€ååªç•™ä¸€é¢—ç å­ã€‚</p>
            <button class="go-btn" onclick="start()">å¼€å¯å¾ç¨‹</button>
        </div>
    </div>
</div>

<div class="game-wrapper">
    <div class="game-info">
        <span id="scoreText">æ®‹ä½™å…µåŠ›ï¼š37</span>
        <button class="reset-btn" onclick="location.reload()">é‡æ–°é›†ç»“</button>
    </div>
    <div id="gameBoard"></div>
</div>

<script>
    const boardLayout = [
        [0,0,1,1,1,0,0], [0,1,1,1,1,1,0], [1,1,1,1,1,1,1], [1,1,1,1,1,1,1],
        [1,1,1,1,1,1,1], [0,1,1,1,1,1,0], [0,0,1,1,1,0,0]
    ];

    let isFirst = true, selected = null;
    const boardEl = document.getElementById('gameBoard');

    // åˆå§‹åŒ–æ£‹ç›˜
    boardLayout.forEach((row, y) => {
        row.forEach((cell, x) => {
            const div = document.createElement('div');
            div.className = 'cell';
            if (cell) {
                const piece = document.createElement('div');
                piece.className = 'piece-slot has-piece';
                piece.dataset.x = x; piece.dataset.y = y;
                piece.dataset.color = Math.floor(Math.random()*5)+1;
                div.appendChild(piece);
            }
            boardEl.appendChild(div);
        });
    });

    function start() {
        document.getElementById('modalOverlay').style.display = 'none';
        if(navigator.vibrate) navigator.vibrate(50);
    }

    boardEl.addEventListener('click', (e) => {
        const target = e.target.closest('.piece-slot');
        if (!target) return;

        if (isFirst) {
            target.classList.remove('has-piece');
            isFirst = false; updateUI(); return;
        }

        if (target.classList.contains('has-piece')) {
            if (selected) selected.classList.remove('selected');
            selected = target;
            target.classList.add('selected');
        } else if (selected) {
            const x1 = +selected.dataset.x, y1 = +selected.dataset.y;
            const x2 = +target.dataset.x, y2 = +target.dataset.y;

            if ((Math.abs(x1-x2) === 2 && y1 === y2) || (Math.abs(y1-y2) === 2 && x1 === x2)) {
                const mx = (x1 + x2) / 2, my = (y1 + y2) / 2;
                const mid = document.querySelector(`[data-x="${mx}"][data-y="${my}"]`);
                
                if (mid && mid.classList.contains('has-piece')) {
                    target.dataset.color = selected.dataset.color;
                    target.classList.add('has-piece');
                    selected.classList.remove('has-piece', 'selected');
                    mid.classList.remove('has-piece');
                    selected = null;
                    updateUI();
                    if(navigator.vibrate) navigator.vibrate(30);
                }
            }
        }
    });

    function updateUI() {
        const count = document.querySelectorAll('.has-piece').length;
        document.getElementById('scoreText').innerText = `æ®‹ä½™å…µåŠ›ï¼š${count}`;
        if(count === 1) alert("å¤©ä½‘ç»Ÿå¸…ï¼æ‚¨èµ¢äº†ã€‚");
    }
</script>
</body>
</html>
